\documentclass[a4paper, notitlepage]{article}
\usepackage{fullpage}
\usepackage{listings}
\usepackage{color}
\usepackage{courier}
\usepackage{graphicx}
\graphicspath{{./pictures/}}
 
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{ltgray}{rgb}{0.9,0.9,0.9}
\definecolor{mauve}{rgb}{0.58,0,0.82}
 
\lstset{ %
  language=Java,
  basicstyle=\ttfamily,           % the size of the fonts that are used for the code
  numbers=left,                   % where to put the line-numbers
  numberstyle=\tiny\color{gray},  % the style that is used for the line-numbers
  stepnumber=1,                   % the step between two line-numbers. If it's 1, each line 
                                  % will be numbered
  numbersep=5pt,                  % how far the line-numbers are from the code
  backgroundcolor=\color{ltgray},      % choose the background color. You must add \usepackage{color}
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  rulecolor=\color{black},        % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. commens (green here))
  tabsize=2,                      % sets default tabsize to 2 spaces
  captionpos=b,                   % sets the caption-position to bottom
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  keywordstyle=\color{blue},          % keyword style
  commentstyle=\color{dkgreen},       % comment style
  stringstyle=\color{mauve},         % string literal style
  escapeinside={\%*}{*)},            % if you want to add a comment within your code
}

\begin{document}

\title{IN4331 Web Data Management, assignment 2 \\
Large-Scale Data Management with Hadoop}
\author{Koen Boes (1314785) and Zmitser Zhaleznichenka (4134575)}
\date{\today}
\maketitle

\setcounter{secnumdepth}{0}

\section{19.5.1}

As far as the combiner should do the same as the reducer, we can reuse the reducer code to action like a combiner. This can be done by adding the following code to the \lstinline{AuthorsJob.main()} method.

\begin{lstlisting}
job.setCombinerClass(Authors.CountReducer.class);  
\end{lstlisting}

\section{19.5.2}

The code of the assignment is placed in \lstinline{nl.tudelft.in4331.hadoop.ex19_5_2} package. It contains a mapper and a reducer, as well as the job description.

To split the incoming XML file into separate \lstinline{<movie>} elements, \lstinline{XMLInputFormat} file is used\footnote{http://xmlandhadoop.blogspot.nl}. With this input format, each \lstinline{map()} call gets a string containing XML description of one film. Later in the mapper this description is parsed with DOM parser and gets deserialized into a \lstinline{Movie} object. The mapper is responsible for emitting two types of key-value pairs for the reducer.

The first pair has key 1 and value needed for "director-and-title" file. The second one respectively has key 2 and value for "title-and-actor" file.

Reducer accepts these pairs and writes them into two different files using \lstinline{MultipleOutputs} with no additional transformations. 

After the job is completed, we get the following contents of the files in Hadoop file system.

\begin{lstlisting}
Unforgiven  Gene Hackman  1930  Little Bill Daggett
A History of Violence  Vigo Mortensen  1958  Tom Stall
A History of Violence  Maria Bello  1967  Eddie Stall
A History of Violence  William Hurt  1950  Richie Cusack
A History of Violence  Ed Harris  1950  Carl Fogarty
Heat  Val Kilmer  1959  Chris Shiherlis
Heat  Robert De Niro  1943  Neil McCauley
Heat  Al Pacino  1940  Lt. Vincent Hanna
Heat  Jon Voight  1938  Nate
Unforgiven  Clint Eastwood  1930  William 'Bill' Munny
Unforgiven  Morgan Freeman  1937  Ned Logan
Match Point  Jonathan Rhys Meyers  1977  Chris Wilton
Match Point  Scarlett  Johansson  1984  Nola Rice
Lost in Translation  Bill Murray  1950  Bob Harris
Lost in Translation  Scarlett  Johansson  1984  Charlotte
Marie Antoinette  Jason  Schwartzman  1980  Louis XVI
Marie Antoinette  Kirsten Dunst  1982  Marie Antoinette
Spider-Man  Tobey Maguire  1975  Spider-Man / Peter Parker
Spider-Man  Willem Dafoe  1955  Green Goblin / Norman Osborn
Spider-Man  Kirsten Dunst  1982  Mary Jane Watson
\end{lstlisting}

\begin{lstlisting}
Michael Mann  Heat  1995
Clint Eastwood  Unforgiven  1992
Sam Raimi  Spider-Man  2002
Sofia Coppola  Lost in Translation  2003
David Cronenberg  A History of Violence  2005
Woody Allen  Match Point  2005
Sofia Coppola  Marie Antoinette  2006
\end{lstlisting}

\section{19.5.3}

\section{19.5.4}

\end{document}
